{% extends 'base.html' %}
{% load static %}

{% block title %}Мебель на заказ{% endblock %}
{% block content %}

<!-- HERO SLIDER -->
<section class="relative h-[80vh] overflow-hidden">
  <div class="swiper h-full" id="hero-swiper">
    <div class="swiper-wrapper">
      {% for s in slides %}
      <div class="swiper-slide relative">
        <!-- фон -->
        <img src="{{ s.image.url }}" 
             class="absolute inset-0 w-full h-full object-cover scale-105 transition-transform duration-[4000ms] ease-out swiper-zoom" 
             alt="{{ s.title }}">
        <!-- затемнение -->
        <div class="absolute inset-0 bg-gradient-to-b from-black/60 via-black/40 to-black/70"></div>

        <!-- контент -->
        <div class="relative z-10 flex h-[80vh] items-center">
          <div class="max-w-7xl mx-auto px-6">
            <h1 class="text-5xl md:text-7xl font-black tracking-tight text-white drop-shadow-[0_2px_10px_rgba(0,0,0,0.5)] leading-tight">
              {{ s.title|default:"Мебель на заказ" }}
            </h1>
            {% if s.subtitle %}
              <p class="text-white/90 text-lg mt-4 max-w-xl leading-relaxed">{{ s.subtitle|safe }}</p>
            {% endif %}
            {% if s.cta_url %}
              <a href="{{ s.cta_url }}" 
                 class="inline-flex mt-8 px-7 py-3 rounded-xl font-semibold bg-emerald-500 hover:bg-emerald-400 text-white
                        shadow-[0_8px_30px_rgba(16,185,129,0.35)] active:scale-[.98] transition">
                {{ s.cta_text|default:"Узнать больше" }}
              </a>
            {% endif %}
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- стрелки -->
    <div class="swiper-button-prev custom-hero-nav"></div>
    <div class="swiper-button-next custom-hero-nav"></div>
  </div>
</section>


<!-- КАТЕГОРИИ -->
<section class="max-w-7xl mx-auto px-6 py-16">
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 sm:gap-0">
  {% include "partials/_heading.html" with kicker="Каталог" title="Мы производим" highlight="" subtitle="" align="left" tone="dark" %}
  
  <button type="button" id="open-measure"
    class="relative group w-full sm:w-auto h-11 px-6 rounded-xl font-semibold text-white text-center
           bg-gradient-to-r from-emerald-600 to-emerald-500
           shadow-[0_8px_25px_rgba(16,185,129,0.35)]
           hover:shadow-[0_10px_35px_rgba(16,185,129,0.45)]
           hover:from-emerald-500 hover:to-emerald-400
           transition-all duration-300 ease-out active:scale-[.97] js-open-measure" data-open="measure">
    Пригласить замерщика
  </button>
</div>

    <div class="grid sm:grid-cols-2 md:grid-cols-3 gap-6 mt-8">
    {% for c in categories_db %}
        <a href="{% url 'category_detail' c.slug %}"
        class="group relative rounded-xl overflow-hidden shadow hover:shadow-lg transition-transform duration-500 ease-out">
        <!-- Мобайл: квадрат; большие: вытянутый 3/4 -->
        <div class="relative w-full aspect-square lg:aspect-[3/4] overflow-hidden">
            <img src="{{ c.image.url }}" alt="{{ c.title }}"
                class="absolute inset-0 w-full h-full object-cover transform transition-transform duration-700 ease-out group-hover:scale-110 group-hover:brightness-90" />
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent
                        transition-opacity duration-500 group-hover:opacity-80"></div>

            <div class="absolute left-4 bottom-4 text-white drop-shadow-lg">
            <div class="text-2xl md:text-3xl font-semibold">{{ c.title }}</div>
            <div class="text-sm text-white/90 opacity-0 translate-y-1
                        transition-all duration-300 ease-out
                        group-hover:opacity-100 group-hover:translate-y-0">
                Смотреть каталог
            </div>
            </div>
        </div>
        </a>
    {% endfor %}
    </div>
    </div>
</section>

<!-- ПОЧЕМУ МЫ -->
{% comment %} ПОЧЕМУ МЫ — адаптивная картинка + анимация {% endcomment %}
<section class="bg-slate-50 py-16">
  <div class="max-w-7xl mx-auto px-6 grid md:grid-cols-2 gap-10 items-center">
    <!-- Левая часть — картинка -->
    {% if usp and usp.image %}
      <div class="relative w-full overflow-hidden rounded-2xl shadow-lg group">
        <!-- соотношение сторон: горизонтальный на мобилке, вертикальный на десктопе -->
        <div class="aspect-[4/3] md:aspect-[3/4] w-full">
          <img src="{{ usp.image.url }}"
               class="absolute inset-0 w-full h-full object-cover transform group-hover:scale-105 transition duration-700 ease-out"
               alt="{{ usp.title }}">
        </div>
      </div>
    {% else %}
      <div class="rounded-2xl bg-gradient-to-br from-slate-200 to-slate-100 h-80"></div>
    {% endif %}

    <!-- Правая часть — контент -->
    <div>
      {% include "partials/_heading.html" with title="Почему выбирают" highlight="нас" subtitle=usp.subtitle align="left" tone="dark" %}

      <ul class="grid gap-4 mt-6">
        {% for i in usp_items %}
          <li class="group relative p-5 rounded-2xl bg-white/80 backdrop-blur
                     ring-1 ring-slate-200 shadow-sm
                     hover:shadow-lg hover:-translate-y-0.5 transition duration-300">
            <div class="flex items-start gap-4">
              <!-- Иконка -->
              <div class="shrink-0 w-12 h-12 rounded-xl bg-slate-900 text-white
                          grid place-items-center
                          group-hover:bg-emerald-600 transition-colors">
                {% if i.icon == "ruler" %}
                  <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.7">
                    <path d="M3 7l14 14 4-4L7 3 3 7zM14 10l-4 4M10 6l-2 2M18 14l-2 2" />
                  </svg>
                {% elif i.icon == "truck" %}
                  <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.7">
                    <path d="M3 7h11v8H3zM14 10h4l3 3v2h-7zM7 19a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm9 0a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>
                  </svg>
                {% elif i.icon == "shield" %}
                  <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.7">
                    <path d="M12 3l7 3v6c0 5-3.5 8-7 9-3.5-1-7-4-7-9V6l7-3z"/>
                  </svg>
                {% elif i.icon == "timer" %}
                  <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.7">
                    <path d="M10 2h4M12 8v5l3 3M5 12a7 7 0 1 0 14 0 7 7 0 0 0-14 0z"/>
                  </svg>
                {% elif i.icon == "cube" %}
                  <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.7">
                    <path d="M12 2l8 4-8 4-8-4 8-4zm-8 6v8l8 4 8-4V8M12 10v8"/>
                  </svg>
                {% else %}
                  <svg viewBox="0 0 24 24" class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="1.7">
                    <path d="M12 17l-5 3 1.5-5.5L4 10l5.6-.4L12 4l2.4 5.6L20 10l-4.5 4.5L17 20z"/>
                  </svg>
                {% endif %}
              </div>

              <div>
                <div class="text-lg font-semibold">{{ i.title }}</div>
                {% if i.text %}
                  <div class="text-slate-600 mt-1">{{ i.text }}</div>
                {% endif %}
              </div>
            </div>
          </li>
        {% empty %}
          <li class="text-slate-500">Преимущества пока не заполнены.</li>
        {% endfor %}
      </ul>
    </div>
  </div>
</section>

<!-- О КОМПАНИИ -->
{% if about %}
<section class="relative py-20 overflow-hidden">
  <!-- тёмный фон + радиальный градиент -->
  <div class="absolute inset-0 bg-slate-950"></div>
  <div class="absolute inset-0"
       style="background: radial-gradient(600px 300px at 50% 0%, rgba(16,185,129,.25), transparent 60%);"></div>

  <div class="relative max-w-5xl mx-auto px-6 text-center">
    {% include "partials/_heading.html" with kicker="" title=about.title highlight="" subtitle=about.subtitle align="center" tone="light" %}


    <!-- гласс-карта -->
    <div class="mt-8 inline-block rounded-2xl p-8 md:p-10
                bg-white/10 backdrop-blur border border-white/15 shadow-2xl">
      <div class="grid sm:grid-cols-3 gap-8 text-center">
        <div>
          <div class="text-4xl font-black text-white tracking-tight">
            {{ about.years }}</div>
          <div class="text-slate-300 mt-1">лет на рынке</div>
        </div>
        <div>
          <div class="text-4xl font-black text-white tracking-tight">
            {{ about.projects }}</div>
          <div class="text-slate-300 mt-1">проектов</div>
        </div>
        <div>
          <div class="text-4xl font-black text-white tracking-tight">
            {{ about.partners }}+</div>
          <div class="text-slate-300 mt-1">партнёров</div>
        </div>
      </div>

      <a href="{{ about.cta_url }}"
         class="mt-8 inline-flex items-center justify-center px-6 py-3
                rounded-xl font-semibold text-white
                bg-emerald-600 hover:bg-emerald-500
                ring-1 ring-emerald-400/40 transition">
        {{ about.cta_text }}
      </a>
    </div>
  </div>
</section>
{% endif %}



<!-- ПОПУЛЯРНОЕ -->
{% if gallery %}
<section class="max-w-7xl mx-auto px-6 py-16" id="portfolio">
  {% include "partials/_heading.html" with kicker="портфолио" title="Наша мебель в" highlight="интерьере" align="left" tone="dark" %}

  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 auto-rows-[200px] md:auto-rows-[260px]">
    {% for img in gallery_images %}
      <a href="{{ img.image.url }}"
         data-gallery="interior"
         {% if img.alt %} data-title="{{ img.alt }}" {% endif %}
         class="glightbox relative group overflow-hidden rounded-2xl shadow-sm hover:shadow-md transition
                {% if img.size == 'wide' %} col-span-2 {% elif img.size == 'tall' %} row-span-2 {% endif %}">
        <img src="{{ img.image.url }}" alt="{{ img.alt }}"
             loading="lazy"
             class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 ease-out">

        <!-- overlay / caption -->
        {% if img.alt %}
        <div class="absolute inset-0 bg-black/0 group-hover:bg-black/40 transition"></div>
        <div class="absolute bottom-3 left-3 text-white opacity-0 group-hover:opacity-100 transition">
          <div class="font-semibold">{{ img.alt }}</div>
        </div>
        {% endif %}

        <!-- иконка просмотра -->
        <div class="absolute top-3 right-3 opacity-0 group-hover:opacity-100 transition">
          <span class="inline-flex items-center justify-center w-8 h-8 rounded-full bg-black/60 text-white">
            <svg viewBox="0 0 24 24" class="w-4 h-4" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7-11-7-11-7z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
          </span>
        </div>
      </a>
    {% empty %}
      <div class="text-slate-500">Галерея пока пуста.</div>
    {% endfor %}
  </div>
</section>
{% endif %}

<!-- ОТЗЫВЫ -->
{% if rev_sec %}
<section class="relative overflow-hidden" id="reviews">
  {% if rev_sec.bg_image %}
    <img src="{{ rev_sec.bg_image.url }}" class="absolute inset-0 w-full h-full object-cover" alt="">
  {% else %}
    <img src="{% static 'img/rev-bg.jpg' %}" class="absolute inset-0 w-full h-full object-cover" alt="">
  {% endif %}

  <!-- ТЕНЕВОЙ ОВЕРЛЕЙ НАД ФОНОМ -->
  <div class="absolute inset-0 pointer-events-none
              bg-gradient-to-b from-black/55 via-black/30 to-black/60"></div>

  <div class="relative max-w-6xl mx-auto px-6 py-24 text-white">
    {% include "partials/_heading.html" with kicker="что говорят клиенты" title="Отзывы клиентов" highlight="" subtitle=rev_sec.subtitle align="left" tone="light" %}


    <div class="swiper" id="reviews-swiper"
         style="padding-left:clamp(32px,6vw,96px);padding-right:clamp(32px,6vw,96px);">
      <div class="swiper-wrapper">
        {% for r in reviews %}
        <div class="swiper-slide">
          <!-- стекло вынесено в отдельный div, без scale-ховера -->
          <div class="glass-card rounded-2xl p-6 md:p-8 min-h-[220px]">
            <div class="flex items-start gap-4">
              {% if r.avatar %}
                <img src="{{ r.avatar.url }}" class="w-12 h-12 md:w-14 md:h-14 rounded-full object-cover" alt="{{ r.author }}">
              {% else %}
                <div class="w-12 h-12 md:w-14 md:h-14 rounded-full bg-white/20 grid place-items-center">👤</div>
              {% endif %}
              <div>
                <div class="font-semibold text-white/95">{{ r.author }}{% if r.city %}, {{ r.city }}{% endif %}</div>
                <div class="flex gap-1 text-amber-300 mt-1 text-lg">
                  {% for i in "12345"|make_list %}
                    {% if forloop.counter <= r.rating %}★{% else %}<span class="text-white/35">☆</span>{% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>
            <blockquote class="mt-5 text-white/90 leading-relaxed italic">“{{ r.text }}”</blockquote>
            {% if r.date %}<div class="mt-3 text-xs text-white/60">{{ r.date }}</div>{% endif %}
          </div>
        </div>
        {% endfor %}
      </div>

      <div class="swiper-button-prev custom-nav"></div>
      <div class="swiper-button-next custom-nav"></div>
      <div class="swiper-pagination"></div>
    </div>
  </div>
</section>
{% endif %}


<section class="relative bg-gradient-to-b from-slate-50 to-white py-20 overflow-hidden">
  <div class="absolute inset-0 pointer-events-none bg-[radial-gradient(ellipse_at_top,rgba(16,185,129,0.08),transparent_60%)]"></div>

  <div class="relative max-w-6xl mx-auto px-6 text-center">
   {% include "partials/_heading.html" with kicker="процесс" title="Как мы работаем" highlight="" align="center" tone="dark" %}


        <div class="grid sm:grid-cols-2 md:grid-cols-4 gap-10">
        {% for step in steps %}
            <div class="group relative flex flex-col items-center text-center animate-fadeInUp"
                style="animation-delay: {{ forloop.counter0|add:'0.1' }}s">
            <div class="relative w-20 h-20 flex items-center justify-center rounded-full bg-white shadow-lg
                        ring-1 ring-emerald-100 group-hover:ring-emerald-300
                        transition-all duration-300 ease-out group-hover:scale-110 group-hover:shadow-emerald-100/50">
                <span class="text-emerald-600 text-3xl font-extrabold drop-shadow-sm">{{ step.num }}</span>
                <div class="absolute inset-0 rounded-full bg-emerald-500/10 opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
            </div>
            <p class="mt-5 text-slate-700 font-medium leading-snug max-w-[180px]">
                {{ step.text }}
            </p>
            </div>
        {% endfor %}
        </div>

    <div class="mt-16">
      <a href="#lead"
         class="inline-flex items-center gap-2 px-8 py-3 rounded-xl text-white font-semibold
                bg-emerald-600 hover:bg-emerald-500 shadow-[0_8px_30px_rgba(16,185,129,0.35)]
                transition-transform active:scale-[.98]">
        Начать проект
        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2"
             viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14m-7-7l7 7-7 7"/></svg>
      </a>
    </div>
  </div>
</section>


<!-- CTA + ФОРМА -->



{% endblock %}
