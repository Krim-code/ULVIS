{% extends "base.html" %}
{% block header %}
  {% include "partials/_header.html" with header_class="header--overlay-dark" %}
{% endblock %}


{% block extra_css %}
<style>
#site-header .header-surface{ background: transparent; }
#site-header.is-scrolled .header-surface{
  background: rgba(255,255,255,0.06);
  backdrop-filter: saturate(140%) blur(8px);
}
/* мод для каталога */
#site-header.header--overlay-dark .header-surface{
  background: linear-gradient(to bottom, rgba(2,6,23,.85), rgba(2,6,23,0));
  backdrop-filter: saturate(140%) blur(6px);
}
#site-header.header--overlay-dark .nav-link,
#site-header.header--overlay-dark a,
#site-header.header--overlay-dark .logo-text{
  color:#fff!important;
}
#site-header.header--overlay-dark .nav-link:hover{ color:#6ee7b7!important; }
#site-header.header--overlay-dark.is-scrolled .header-surface{
  background: linear-gradient(to bottom, rgba(2,6,23,.9), rgba(2,6,23,0));
}
</style>
{% endblock %}
{% load static %}

{% block title %}{{ meta_title }}{% endblock %}
{% block meta %}
  <meta name="description" content="{{ meta_description }}">
{% endblock %}

{% block content %}

<section class="pt-24 pb-6 bg-slate-50">
  <div class="max-w-7xl mx-auto px-6">
    <h1 class="text-3xl md:text-4xl font-black tracking-tight text-slate-900">Каталог</h1>

    <!-- поиск (опционально) -->
    <form method="get" class="mt-4 flex items-center gap-3">
      <input type="text" name="q" value="{{ q }}" placeholder="Найти категорию…"
             class="w-full md:w-96 rounded-xl border border-slate-200 bg-white p-3
                    focus:outline-none focus:ring-2 focus:ring-emerald-500">
      {% if q %}
        <a href="{% url 'catalog' %}" class="text-sm text-slate-500 hover:text-slate-700">Сброс</a>
      {% endif %}
    </form>
  </div>
</section>

<section class="max-w-7xl mx-auto px-6 py-8">
  {% if categories %}
    <div class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
      {% for c in categories %}
        <a href="{% url 'category_detail' c.slug %}"
           class="group relative rounded-2xl overflow-hidden shadow-sm hover:shadow-lg transition">
          <div class="relative w-full aspect-square">
            <img src="{{ c.image.url }}" alt="{{ c.title }}"
                 class="absolute inset-0 w-full h-full object-cover transform
                        transition-transform duration-700 ease-out group-hover:scale-105 group-hover:brightness-95">
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent
                        opacity-0 group-hover:opacity-100 transition"></div>

            <div class="absolute left-4 right-4 bottom-4">
              <div class="text-white text-xl font-semibold drop-shadow">{{ c.title }}</div>
              <div class="text-white/90 text-xs opacity-0 translate-y-1
                          transition-all duration-300 group-hover:opacity-100 group-hover:translate-y-0">
                Смотреть категорию
              </div>
            </div>
          </div>
        </a>
      {% endfor %}
    </div>

    <!-- пагинация -->
    {% if page_obj.paginator.num_pages > 1 %}
      <div class="mt-8 flex items-center justify-center gap-2">
        {% if page_obj.has_previous %}
          <a href="?{% if q %}q={{ q|urlencode }}&{% endif %}page={{ page_obj.previous_page_number }}"
             class="px-3 py-2 rounded-lg border border-slate-200 hover:bg-slate-50">Назад</a>
        {% endif %}

        <span class="px-3 py-2 text-sm text-slate-600">
          Стр. {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
          <a href="?{% if q %}q={{ q|urlencode }}&{% endif %}page={{ page_obj.next_page_number }}"
             class="px-3 py-2 rounded-lg border border-slate-200 hover:bg-slate-50">Вперёд</a>
        {% endif %}
      </div>
    {% endif %}
  {% else %}
    <div class="text-slate-500">Пока пусто. Добавь категории в админке.</div>
  {% endif %}
</section>

{% endblock %}
